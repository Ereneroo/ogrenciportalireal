<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Portal - Italy Universities Map</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f7fa;
            color: #333;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
        }
        
        .sidebar {
            width: 250px;
            background: linear-gradient(135deg, #2c3e50, #1a1a2e);
            color: white;
            padding: 20px;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }
        
        .logo {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .logo h2 {
            margin: 10px 0;
            font-weight: 300;
        }
        
        .menu {
            list-style: none;
            padding: 0;
        }
        
        .menu li {
            margin-bottom: 10px;
        }
        
        .menu a {
            color: #ecf0f1;
            text-decoration: none;
            display: block;
            padding: 10px 15px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .menu a:hover, .menu a.active {
            background-color: rgba(255,255,255,0.1);
            color: #3498db;
        }
        
        .menu i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        
        .main-content {
            flex: 1;
            padding: 30px;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
        }
        
        .user-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        #map-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            padding: 20px;
            position: relative;
        }
        
        #italy-map {
            width: 100%;
            height: 600px;
        }
        
        .region {
            stroke: #fff;
            stroke-width: 1px;
            transition: all 0.3s ease;
        }
        
        .region:hover {
            opacity: 0.8;
            stroke-width: 2px;
        }
        
        .tooltip {
            position: absolute;
            padding: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            border-radius: 5px;
            pointer-events: none;
            font-size: 14px;
            z-index: 10;
        }
        
        .university-list {
            position: absolute;
            background: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            padding: 20px;
            width: 300px;
            max-height: 500px;
            overflow-y: auto;
            z-index: 100;
            display: none;
        }
        
        .university-list h3 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .university-item {
            padding: 10px 0;
            border-bottom: 1px solid #f1f1f1;
        }
        
        .university-item:last-child {
            border-bottom: none;
        }
        
        .close-btn {
            position: absolute;
            right: 15px;
            top: 15px;
            cursor: pointer;
            color: #7f8c8d;
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="logo">
                <h2>Student Portal</h2>
            </div>
            <ul class="menu">
                <li><a href="#" class="active"><i>üó∫Ô∏è</i> University Map</a></li>
                <li><a href="#"><i>üìö</i> My Courses</a></li>
                <li><a href="#"><i>‚úâÔ∏è</i> Messages</a></li>
                <li><a href="#"><i>üìù</i> Applications</a></li>
                <li><a href="#"><i>üìÖ</i> Calendar</a></li>
                <li><a href="#"><i>‚öôÔ∏è</i> Settings</a></li>
                <li><a href="#"><i>üìû</i> Contact</a></li>
            </ul>
        </div>
        
        <div class="main-content">
            <div class="header">
                <h1>Italy Universities Map</h1>
                <div class="user-info">
                    <img src="https://via.placeholder.com/40" alt="User">
                    <span>Welcome, Student</span>
                </div>
            </div>
            
            <div id="map-container">
                <div id="italy-map"></div>
                <div class="tooltip"></div>
                <div class="university-list">
                    <span class="close-btn">‚úï</span>
                    <h3>Universities in <span id="region-name"></span></h3>
                    <div id="university-items"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Map dimensions and setup
        const width = 900;
        const height = 600;
        
        // Create SVG container
        const svg = d3.select("#italy-map")
            .append("svg")
            .attr("width", "100%")
            .attr("height", "100%")
            .attr("viewBox", `0 0 ${width} ${height}`);
        
        // Tooltip setup
        const tooltip = d3.select(".tooltip");
        
        // University list elements
        const universityList = d3.select(".university-list");
        const regionName = d3.select("#region-name");
        const universityItems = d3.select("#university-items");
        const closeBtn = d3.select(".close-btn");
        
        // Close university list
        closeBtn.on("click", function() {
            universityList.style("display", "none");
        });
        
        // Italy regions dataset
        const italyRegions = {
            "Abruzzo": {
                fill: "#3498db",
                universities: [
                    "University of L'Aquila",
                    "Gabriele d'Annunzio University",
                    "University of Teramo"
                ]
            },
            "Aosta Valley": {
                fill: "#e74c3c",
                universities: [
                    "University of Valle d'Aosta"
                ]
            },
            "Apulia": {
                fill: "#2ecc71",
                universities: [
                    "University of Bari",
                    "Polytechnic University of Bari",
                    "University of Foggia",
                    "University of Salento"
                ]
            },
            "Basilicata": {
                fill: "#f39c12",
                universities: [
                    "University of Basilicata"
                ]
            },
            "Calabria": {
                fill: "#9b59b6",
                universities: [
                    "University of Calabria",
                    "Mediterranean University of Reggio Calabria"
                ]
            },
            "Campania": {
                fill: "#1abc9c",
                universities: [
                    "University of Naples Federico II",
                    "University of Sannio",
                    "Second University of Naples",
                    "University of Naples Parthenope",
                    "Suor Orsola Benincasa University of Naples"
                ]
            },
            "Emilia-Romagna": {
                fill: "#d35400",
                universities: [
                    "University of Bologna",
                    "University of Modena and Reggio Emilia",
                    "University of Parma",
                    "University of Ferrara",
                    "University of Rimini",
                    "University of Forl√¨"
                ]
            },
            "Friuli-Venezia Giulia": {
                fill: "#34495e",
                universities: [
                    "University of Trieste",
                    "University of Udine"
                ]
            },
            "Lazio": {
                fill: "#16a085",
                universities: [
                    "Sapienza University of Rome",
                    "University of Rome Tor Vergata",
                    "Roma Tre University",
                    "University of Tuscia",
                    "University of Cassino and Southern Lazio"
                ]
            },
            "Liguria": {
                fill: "#c0392b",
                universities: [
                    "University of Genoa"
                ]
            },
            "Lombardy": {
                fill: "#8e44ad",
                universities: [
                    "University of Milan",
                    "University of Pavia",
                    "University of Bergamo",
                    "University of Brescia",
                    "University of Insubria",
                    "Catholic University of the Sacred Heart",
                    "University of Milan-Bicocca"
                ]
            },
            "Marche": {
                fill: "#27ae60",
                universities: [
                    "University of Urbino",
                    "University of Camerino",
                    "University of Macerata",
                    "Marche Polytechnic University"
                ]
            },
            "Molise": {
                fill: "#e67e22",
                universities: [
                    "University of Molise"
                ]
            },
            "Piedmont": {
                fill: "#2980b9",
                universities: [
                    "University of Turin",
                    "University of Eastern Piedmont",
                    "Polytechnic University of Turin",
                    "University of Gastronomic Sciences"
                ]
            },
            "Sardinia": {
                fill: "#f1c40f",
                universities: [
                    "University of Cagliari",
                    "University of Sassari"
                ]
            },
            "Sicily": {
                fill: "#e84393",
                universities: [
                    "University of Catania",
                    "University of Messina",
                    "University of Palermo",
                    "University of Enna",
                    "Kore University of Enna"
                ]
            },
            "Trentino-Alto Adige": {
                fill: "#00cec9",
                universities: [
                    "University of Trento",
                    "Free University of Bozen-Bolzano"
                ]
            },
            "Tuscany": {
                fill: "#fd79a8",
                universities: [
                    "University of Florence",
                    "University of Pisa",
                    "University of Siena",
                    "University for Foreigners of Siena",
                    "Sant'Anna School of Advanced Studies",
                    "Scuola Normale Superiore di Pisa"
                ]
            },
            "Umbria": {
                fill: "#636e72",
                universities: [
                    "University of Perugia",
                    "University for Foreigners of Perugia"
                ]
            },
            "Veneto": {
                fill: "#6c5ce7",
                universities: [
                    "University of Padua",
                    "University of Verona",
                    "Ca' Foscari University of Venice",
                    "IUAV University of Venice",
                    "University of Venice"
                ]
            }
        };
        
        // Load and draw Italy map (using a simplified path for demonstration)
        // In a real implementation, you would use TopoJSON or GeoJSON data
        d3.json("https://raw.githubusercontent.com/dataarts/dat.gui/master/examples/world.geo.json").then(function(world) {
            // For demonstration, we'll draw simplified regions - in real use, get exact Italy regions JSON
            
            // Draw a simplified Italy shape (in real implementation, use proper Italy regions data)
            svg.append("path")
                .datum(topojson.feature(world, world.objects.countries))
                .attr("d", d3.geoPath().fitSize([width, height], {type: "FeatureCollection", features: [
                    {type: "Feature", properties: {}, geometry: {type: "Point", coordinates: [12.5, 42.5]}}
                ]}))
                .attr("fill", "#ecf0f1")
                .attr("stroke", "#bdc3c7");
                
            // Draw regions (simplified for this example)
            // In a real implementation, you would load Italy's regional boundaries
            const regions = Object.keys(italyRegions);
            
            regions.forEach((region, i) => {
                // Calculate position for simplified demo regions
                const x = 200 + (i % 5) * 150;
                const y = 100 + Math.floor(i / 5) * 150;
                
                // Draw region shape (in real implementation, use actual region boundaries)
                svg.append("path")
                    .attr("class", "region")
                    .attr("d", `M${x},${y} L${x+100},${y} L${x+50},${y+100} Z`)
                    .attr("fill", italyRegions[region].fill)
                    .attr("data-region", region)
                    .on("mouseover", function(event) {
                        const currentRegion = d3.select(this).attr("data-region");
                        tooltip.style("visibility", "visible")
                               .html(`<strong>${currentRegion}</strong><br>Click to see universities`)
                               .style("left", (event.pageX + 10) + "px")
                               .style("top", (event.pageY - 10) + "px");
                        d3.select(this).attr("stroke", "#000").attr("stroke-width", 2);
                    })
                    .on("mouseout", function() {
                        tooltip.style("visibility", "hidden");
                        d3.select(this).attr("stroke", "#fff").attr("stroke-width", 1);
                    })
                    .on("click", function(event) {
                        const currentRegion = d3.select(this).attr("data-region");
                        showUniversities(currentRegion, event.pageX, event.pageY);
                    });
                
                // Add region label
                svg.append("text")
                    .attr("x", x + 50)
                    .attr("y", y + 40)
                    .attr("text-anchor", "middle")
                    .text(region)
                    .style("fill", "white")
                    .style("font-size", "10px")
                    .style("pointer-events", "none");
            });
        }).catch(function(error) {
            console.error("Error loading map data:", error);
            // Fallback drawing if map data fails to load
            svg.append("text")
                .attr("x", width / 2)
                .attr("y", height / 2)
                .attr("text-anchor", "middle")
                .text("Italy Map Loading Failed - Please Refresh");
        });
        
        // Show universities for a region
        function showUniversities(region, x, y) {
            regionName.text(region);
            
            // Clear previous universities
            universityItems.html("");
            
            // Add universities to list
            italyRegions[region].universities.forEach(uni => {
                universityItems.append("div")
                    .attr("class", "university-item")
                    .text(uni);
            });
            
            // Position and show the list
            universityList.style("left", (x - 150) + "px")
                         .style("top", (y - 100) + "px")
                         .style("display", "block");
        }
    </script>
</body>
</html>
